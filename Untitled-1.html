<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>è‡ªåŠ¨å¼¹å‡ºä¾¿ç­¾ç¤¼ç‰©</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            font-family: 'Comic Sans MS', 'å¾®è½¯é›…é»‘', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .start-btn {
            padding: 15px 40px;
            background: #ff9a8b;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            transition: background 0.3s;
            z-index: 100;
            position: relative;
        }
        .start-btn:hover {
            background: #ff6b5b;
        }
        .start-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .note-modal {
            position: absolute;
            width: 220px;
            padding: 20px;
            background: #fff9c4;
            border: 1px solid #ffe082;
            border-radius: 8px;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.15);
            transform: rotate(var(--rotate, -2deg));
            z-index: 10;
            cursor: move;
        }
        .note-modal:hover {
            box-shadow: 5px 5px 15px rgba(0,0,0,0.2);
        }
        .note-content {
            font-size: 16px;
            color: #333;
            line-height: 1.5;
            background: transparent;
            border: none;
            width: 100%;
            resize: none;
            outline: none;
            font-family: inherit;
            padding: 5px;
            border-radius: 4px;
            transition: background 0.3s;
        }
        .note-content:hover {
            background: rgba(255,255,255,0.5);
        }
        .note-content:focus {
            background: rgba(255,255,255,0.8);
        }
        .note-footer {
            margin-top: 15px;
            font-size: 12px;
            color: #666;
            text-align: right;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #ff4444;
            cursor: pointer;
            font-size: 16px;
            padding: 2px 6px;
            border-radius: 4px;
            transition: background 0.3s;
        }
        .delete-btn:hover {
            background: rgba(255,68,68,0.1);
        }
        .dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-number {
            font-size: 14px;
            color: #666;
            font-weight: bold;
        }
        .edit-hint {
            font-size: 12px;
            color: #999;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .note-modal:hover .edit-hint {
            opacity: 1;
        }
    </style>
</head>
<body>
    <button class="start-btn" onclick="startAutoNote()">å¼€å§‹å¼¹å‡ºç¥ç§˜ç¤¼ç‰©</button>

    <script>
        let modalCount = 0;
        let noteInterval;
        let isDragging = false;
        let currentNote = null;
        let offsetX, offsetY;

        // ç¥ç¦è¯­æ•°ç»„
        const blessings = [
            "æ„¿ä½ çš„æ¯ä¸€å¤©éƒ½å……æ»¡é˜³å…‰å’Œæ¬¢ç¬‘",
            "æ„¿æ‰€æœ‰ç¾å¥½çš„äº‹æƒ…éƒ½ä¸ä½ ç›¸ä¼´",
            "ç¥ä½ å¹¸ç¦å¿«ä¹ï¼Œä¸‡äº‹å¦‚æ„",
            "æ„¿ä½ æ°¸è¿œå¹´è½»ï¼Œæ°¸è¿œçƒ­æ³ªç›ˆçœ¶",
            "æ„¿ä½ è¢«è¿™ä¸ªä¸–ç•Œæ¸©æŸ”ä»¥å¾…"
        ];

        function getRandomPos() {
            const maxX = window.innerWidth - 260;
            const maxY = window.innerHeight - 180;
            const x = Math.floor(Math.random() * maxX);
            const y = Math.floor(Math.random() * maxY);
            const rotate = (Math.random() * 4 - 2) + 'deg';
            return { x, y, rotate };
        }

        function createNoteModal() {
            modalCount++;
            const { x, y, rotate } = getRandomPos();
            const note = document.createElement('div');
            note.className = 'note-modal';
            note.style.left = x + 'px';
            note.style.top = y + 'px';
            note.style.setProperty('--rotate', rotate);
            
            // éšæœºé€‰æ‹©ä¸€æ¡ç¥ç¦è¯­
            const blessing = blessings[Math.floor(Math.random() * blessings.length)];
            
            note.innerHTML = `
                <div class="note-header">
                    <span class="note-number">ğŸ ç¤¼ç‰© #${modalCount}</span>
                    <span class="edit-hint">å¯ç¼–è¾‘</span>
                </div>
                <textarea class="note-content" rows="4">${blessing}</textarea>
                <div class="note-footer">
                    <span>ç¥ç§˜ç¤¼ç‰©åº“</span>
                    <button class="delete-btn" onclick="deleteNote(this)">âœ•</button>
                </div>
            `;

            // æ·»åŠ æ‹–æ‹½åŠŸèƒ½
            note.addEventListener('mousedown', startDrag);
            
            // æ·»åŠ è‡ªåŠ¨ä¿å­˜åŠŸèƒ½
            const textarea = note.querySelector('.note-content');
            textarea.addEventListener('input', () => {
                // è¿™é‡Œå¯ä»¥æ·»åŠ ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨çš„é€»è¾‘
                localStorage.setItem(`note-${modalCount}`, textarea.value);
            });

            // å¦‚æœæœ‰ä¿å­˜çš„å†…å®¹ï¼Œåˆ™æ¢å¤
            const savedContent = localStorage.getItem(`note-${modalCount}`);
            if (savedContent) {
                textarea.value = savedContent;
            }
            
            document.body.appendChild(note);
        }

        function deleteNote(btn) {
            const note = btn.closest('.note-modal');
            const noteNumber = note.querySelector('.note-number').textContent;
            note.style.transform = 'scale(0)';
            setTimeout(() => {
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                localStorage.removeItem(`note-${modalCount}`);
                note.remove();
            }, 300);
        }

        function startDrag(e) {
            if (e.target.classList.contains('note-content') || 
                e.target.classList.contains('delete-btn')) {
                return;
            }
            
            isDragging = true;
            currentNote = e.currentTarget;
            currentNote.classList.add('dragging');
            
            const rect = currentNote.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function drag(e) {
            if (!isDragging) return;
            
            const x = e.clientX - offsetX;
            const y = e.clientY - offsetY;
            
            currentNote.style.left = x + 'px';
            currentNote.style.top = y + 'px';
        }

        function stopDrag() {
            isDragging = false;
            if (currentNote) {
                currentNote.classList.remove('dragging');
            }
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }

        function startAutoNote() {
            document.querySelector('.start-btn').disabled = true;
            document.querySelector('.start-btn').textContent = 'æ­£åœ¨å¼¹å‡º...';
            
            // è°ƒæ•´ä¸ºæ¯500æ¯«ç§’å¼¹å‡ºä¸€ä¸ª
            noteInterval = setInterval(createNoteModal, 500);
            
            // 10ç§’ååœæ­¢å¼¹å‡º
            setTimeout(() => {
                clearInterval(noteInterval);
                document.querySelector('.start-btn').disabled = false;
                document.querySelector('.start-btn').textContent = 'å¼€å§‹å¼¹å‡ºç¥ç§˜ç¤¼ç‰©';
            }, 10000);
        }
    </script>
</body>
</html>
